---
phase: 40.3-revert-to-explorer-only
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - frontend/src/main.tsx
  - frontend/src/pages/BrowsePage.tsx
  - frontend/src/hooks/useBrowse.ts
  - frontend/src/components/browse/BrowseCard.tsx
  - frontend/src/components/browse/BrowseRow.tsx
  - frontend/src/components/browse/HeroBanner.tsx
  - frontend/src/components/browse/SkeletonBrowseCard.tsx
  - frontend/src/components/browse/SkeletonBrowseRow.tsx
  - frontend/src/components/browse/SkeletonHeroBanner.tsx
  - frontend/src/store/navigationSlice.ts
  - frontend/src/store/index.ts
  - frontend/src/pages/MarketplacePage.tsx
  - frontend/src/components/pilot/SagePopover.tsx
autonomous: true
requirements: []

must_haves:
  truths:
    - "Visiting / serves the Explorer page (MarketplacePage) with search bar and expert grid"
    - "Visiting /browse redirects permanently to /"
    - "Visiting /explore redirects to / (preserving query params)"
    - "Visiting /marketplace redirects to / (preserving query params)"
    - "No Browse-specific components remain in the codebase"
    - "navigationSlice is removed from the Zustand store — store type is FilterSlice & ResultsSlice & PilotSlice"
    - "MarketplacePage no longer references navigationSource for pilot reset — pilot resets on every mount"
  artifacts:
    - path: "frontend/src/main.tsx"
      provides: "Route configuration with / serving Explorer"
      contains: "MarketplacePage"
    - path: "frontend/src/store/index.ts"
      provides: "Zustand store without navigationSlice"
  key_links:
    - from: "frontend/src/main.tsx"
      to: "frontend/src/pages/MarketplacePage.tsx"
      via: "route path /"
      pattern: "path.*/"
---

<objective>
Delete all Browse-specific frontend components, restructure routes so `/` serves Explorer, remove navigationSlice from Zustand store, and clean up all cross-page navigation logic.

Purpose: Revert to single-page Explorer-only architecture by removing Browse page and all supporting code.
Output: Clean route structure with Explorer at `/`, no Browse components, simplified Zustand store.
</objective>

<execution_context>
@/Users/sebastianhamers/.claude/get-shit-done/workflows/execute-plan.md
@/Users/sebastianhamers/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/STATE.md
@.planning/ROADMAP.md
@.planning/phases/40.3-revert-to-explorer-only-remove-browse-page-keep-explorer-with-adjustments/40.3-CONTEXT.md
@.planning/phases/40.3-revert-to-explorer-only-remove-browse-page-keep-explorer-with-adjustments/40.3-RESEARCH.md
@frontend/src/main.tsx
@frontend/src/store/index.ts
@frontend/src/store/navigationSlice.ts
@frontend/src/pages/MarketplacePage.tsx
@frontend/src/pages/BrowsePage.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Delete Browse components and restructure routes</name>
  <files>
    frontend/src/pages/BrowsePage.tsx
    frontend/src/hooks/useBrowse.ts
    frontend/src/components/browse/BrowseCard.tsx
    frontend/src/components/browse/BrowseRow.tsx
    frontend/src/components/browse/HeroBanner.tsx
    frontend/src/components/browse/SkeletonBrowseCard.tsx
    frontend/src/components/browse/SkeletonBrowseRow.tsx
    frontend/src/components/browse/SkeletonHeroBanner.tsx
    frontend/src/components/pilot/SagePopover.tsx
    frontend/src/main.tsx
  </files>
  <action>
    1. DELETE these files entirely (rm):
       - frontend/src/pages/BrowsePage.tsx
       - frontend/src/hooks/useBrowse.ts
       - frontend/src/components/browse/BrowseCard.tsx
       - frontend/src/components/browse/BrowseRow.tsx
       - frontend/src/components/browse/HeroBanner.tsx
       - frontend/src/components/browse/SkeletonBrowseCard.tsx
       - frontend/src/components/browse/SkeletonBrowseRow.tsx
       - frontend/src/components/browse/SkeletonHeroBanner.tsx
       - frontend/src/components/pilot/SagePopover.tsx (Browse-only Sage surface)
    2. Delete the now-empty frontend/src/components/browse/ directory.

    3. EDIT frontend/src/main.tsx — restructure routes:
       - Remove BrowsePage import entirely.
       - Change the RootLayout children: `/` path serves `<MarketplacePage />` (was BrowsePage).
       - Remove the `/explore` route from RootLayout children (no longer a separate path).
       - Add redirect routes OUTSIDE the RootLayout element:
         - `/explore` → uses a `RedirectWithParams` component that reads useSearchParams and redirects to `/?{params}` (preserve query params like the existing MarketplaceRedirect pattern).
         - `/browse` → `<Navigate to="/" replace />` (permanent redirect, no params to preserve).
       - Update the existing `/marketplace` redirect: change MarketplaceRedirect destination from `/explore?${queryString}` to `/?${queryString}`.
       - Keep the `/chat` redirect but change target from `/explore` to `/`.

    IMPORTANT: The RedirectWithParams component pattern — create it inline like MarketplaceRedirect:
    ```tsx
    function RedirectWithParams({ to }: { to: string }) {
      const [searchParams] = useSearchParams()
      const qs = searchParams.toString()
      return <Navigate to={qs ? `${to}?${qs}` : to} replace />
    }
    ```
    Then reuse it for /explore and /marketplace:
    - `/explore` → `<RedirectWithParams to="/" />`
    - `/marketplace` → `<RedirectWithParams to="/" />`
    Remove the old MarketplaceRedirect function (replaced by generic RedirectWithParams).
  </action>
  <verify>Run `npx tsc --noEmit` from frontend/ directory — no type errors from deleted imports. Verify deleted files no longer exist: `ls frontend/src/components/browse/ 2>&1` should say "No such file or directory".</verify>
  <done>All Browse-specific files deleted. Route `/` serves MarketplacePage. `/explore`, `/browse`, `/marketplace` all redirect to `/`. No BrowsePage import in codebase.</done>
</task>

<task type="auto">
  <name>Task 2: Remove navigationSlice and simplify MarketplacePage</name>
  <files>
    frontend/src/store/navigationSlice.ts
    frontend/src/store/index.ts
    frontend/src/pages/MarketplacePage.tsx
  </files>
  <action>
    1. DELETE frontend/src/store/navigationSlice.ts entirely.

    2. EDIT frontend/src/store/index.ts:
       - Remove `import { createNavigationSlice } from './navigationSlice'`
       - Remove `import type { NavigationSlice } from './navigationSlice'`
       - Remove `NavigationSlice` from the re-export types line
       - Remove `NavigationSlice` from the `ExplorerStore` type union (becomes `FilterSlice & ResultsSlice & PilotSlice`)
       - Remove `...createNavigationSlice(...a),` from the persist store creator
       - Everything else stays (persist config, slice hooks, etc.)

    3. EDIT frontend/src/pages/MarketplacePage.tsx:
       - Remove the entire navigationSource/pilot reset useEffect block (lines that import and use `resetPilot`, `navigationSource`, `setNavigationSource`). Without Browse, there's no cross-page navigation to guard against. Pilot reset is no longer needed — Sage state persists within a session, and page refreshes naturally reset the SPA state.
       - Remove the `useExplorerStore` selectors for `resetPilot`, `navigationSource`, `setNavigationSource` (3 lines).
       - Remove the `useEffect` block that checks `navigationSource === 'direct'` and calls `resetPilot()`.
       - Keep all other MarketplacePage functionality intact (filters, grid, email gate, mobile toolbar, etc.).

    IMPORTANT: After removing navigationSlice, grep the entire frontend/src/ for any remaining references to:
       - `navigationSource` / `setNavigationSource`
       - `pendingSageResults` / `setPendingSageResults` / `clearPendingSageResults`
       - `browseData` / `setBrowseData` / `CachedBrowseData`
       - `NavigationSlice` / `createNavigationSlice`
    These should ONLY remain in files that will be cleaned in Plan 02 (useSage.ts, useExplore.ts, RootLayout.tsx). If found elsewhere, clean them up.
  </action>
  <verify>Run `npx tsc --noEmit` from frontend/ — expect errors only in useSage.ts, useExplore.ts, and RootLayout.tsx (cleaned in Plan 02). Verify `grep -r "navigationSlice" frontend/src/store/` returns nothing.</verify>
  <done>navigationSlice.ts deleted. Store type is FilterSlice & ResultsSlice & PilotSlice. MarketplacePage no longer references navigation source or pilot reset logic.</done>
</task>

</tasks>

<verification>
- `ls frontend/src/components/browse/` returns "No such file or directory"
- `ls frontend/src/pages/BrowsePage.tsx` returns "No such file"
- `ls frontend/src/hooks/useBrowse.ts` returns "No such file"
- `ls frontend/src/store/navigationSlice.ts` returns "No such file"
- `ls frontend/src/components/pilot/SagePopover.tsx` returns "No such file"
- `grep -r "BrowsePage" frontend/src/` returns nothing
- `grep -r "useBrowse" frontend/src/` returns nothing
- `grep -r "navigationSlice" frontend/src/store/` returns nothing
- main.tsx has `path: '/'` pointing to MarketplacePage
</verification>

<success_criteria>
- All Browse-specific frontend components deleted (8 files + SagePopover)
- Route `/` serves Explorer (MarketplacePage)
- Routes `/browse`, `/explore`, `/marketplace` all redirect to `/`
- navigationSlice removed from Zustand store
- MarketplacePage has no cross-page navigation logic
- TypeScript compilation has no errors in modified files (errors may remain in useSage/useExplore/RootLayout — addressed in Plan 02)
</success_criteria>

<output>
After completion, create `.planning/phases/40.3-revert-to-explorer-only-remove-browse-page-keep-explorer-with-adjustments/40.3-01-SUMMARY.md`
</output>
