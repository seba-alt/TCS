# Requirements Archive: v2.2 Evolved Discovery Engine

**Archived:** 2026-02-22
**Status:** SHIPPED

For current requirements, see `.planning/REQUIREMENTS.md`.

---

# Requirements: Tinrate AI Concierge

**Defined:** 2026-02-22
**Core Value:** A user describes any problem and instantly gets expertly matched professionals they can browse, filter, and contact — no searching, no guesswork.

## v2.2 Requirements

Requirements for milestone v2.2 "Evolved Discovery Engine". Phases continue from Phase 22 (v2.0 ended at Phase 21).

### VIS — Visual Metamorphosis

- [ ] **VIS-01**: Marketplace renders with OKLCH-defined aurora mesh gradient background and slow ambient CSS keyframe animation
- [ ] **VIS-02**: FilterSidebar renders with glassmorphism surface (backdrop-filter: blur, translucent bg, subtle border)
- [ ] **VIS-03**: SearchInput renders with glassmorphism surface matching sidebar style
- [ ] **VIS-04**: SagePanel renders with glassmorphism surface
- [ ] **VIS-05**: All glass surfaces maintain legibility (contrast ≥ 4.5:1) and degrade gracefully on unsupported browsers

### CARD — Bento Expert Cards

- [ ] **CARD-01**: ExpertCard redesigned as bento-style card with distinct visual zones (name/role, rate+badge, tags, match reason)
- [ ] **CARD-02**: ExpertCard maintains h-[180px] fixed height (VirtuosoGrid compatibility)
- [ ] **CARD-03**: ExpertCard hover animation updated to complement aurora palette (glow shifts to match new tokens)

### DISC — Discovery Engine

- [x] **DISC-01**: TagMultiSelect replaced with animated interactive tag cloud using Framer Motion layout animations
- [ ] **DISC-02**: Tag cloud items exhibit proximity-based scale increase (claymorphism) on cursor hover/approach
- [ ] **DISC-03**: "Everything is possible" animated element renders beneath tag cloud with example quirky tags
- [ ] **DISC-04**: Tag cloud remains keyboard-navigable and aria-labeled (selection behavior unchanged)

### IDX — Atomic Index Swap

- [ ] **IDX-01**: Admin can trigger FAISS index rebuild from admin panel
- [ ] **IDX-02**: Index rebuild runs in `asyncio.to_thread` — live index serves requests without interruption
- [ ] **IDX-03**: On completion, `app.state.faiss_index` swaps atomically (no inconsistency window)
- [ ] **IDX-04**: Rebuild progress status (idle/running/complete/failed + timestamp) is visible in admin panel

### INTEL — Admin Findability Intelligence

- [ ] **INTEL-01**: OTR@K (On-Topic Rate, K=10) computed per search query and stored in `conversations` table
- [ ] **INTEL-02**: Admin Intelligence dashboard displays OTR@K 7-day rolling average
- [ ] **INTEL-03**: Index Drift metric tracks time since last rebuild and expert count delta since rebuild
- [ ] **INTEL-04**: Admin Intelligence dashboard displays Index Drift status with last-rebuilt timestamp
- [x] **INTEL-05**: Backend exposes `/api/admin/embedding-map` returning t-SNE 2D projection (scikit-learn, computed at startup from FAISS index, cached in `app.state`)
- [x] **INTEL-06**: Admin displays interactive embedding scatter plot (points colored by category, expert name on hover)

### NLTR — Newsletter Gate

- [x] **NLTR-01**: Email gate redesigned as newsletter subscription CTA ("Get expert insights to your inbox. Unlock profiles.")
- [x] **NLTR-02**: Email submission creates record in new `newsletter_subscribers` table (email, created_at, source)
- [x] **NLTR-03**: Newsletter subscription state (subscribed, email) persists via Zustand + localStorage
- [x] **NLTR-04**: Admin Leads page shows newsletter subscriber count and subscriber list

### FUN — Easter Egg

- [x] **FUN-01**: Sage query or search containing playful trigger phrases (e.g. "barrel roll", "do a flip") triggers 360° card animation via Framer Motion on ExpertCards

## Future Requirements (v2.3+)

### HEATMAP — Advanced Visualisation

- **UMAP**: Runtime UMAP projection (umap-learn) for higher-quality embedding layout — deferred (heavy Railway dep)

### LEAD — Match Reports

- **LEAD-03**: In-app match report download — deferred from v2.0, re-evaluate after v2.2 newsletter data

## Out of Scope

| Feature | Reason |
|---------|--------|
| Tailwind v4 migration | Breaking config change, zero visual benefit over v3 with OKLCH tokens |
| SQLModel migration | SQLAlchemy is fully capable; refactoring risks regressions across 6 routers |
| External newsletter service (Mailchimp, etc.) | SQLite capture sufficient; export to service manually if needed |
| Cursor-reactive aurora (JS mousemove) | CSS keyframe animation achieves ambient motion with zero JS cost |
| Re-implementing hybrid scoring | FAISS 0.7 + BM25 0.3 already live in explorer.py since v2.0 Phase 14 |

## Traceability

Which phases cover which requirements. Updated during roadmap creation.

| Requirement | Phase | Status |
|-------------|-------|--------|
| VIS-01 | Phase 22 | Pending |
| VIS-02 | Phase 22 | Pending |
| VIS-03 | Phase 22 | Pending |
| VIS-04 | Phase 22 | Pending |
| VIS-05 | Phase 22 | Pending |
| CARD-01 | Phase 23 | Pending |
| CARD-02 | Phase 23 | Pending |
| CARD-03 | Phase 23 | Pending |
| DISC-01 | Phase 23 | Complete |
| DISC-02 | Phase 23 | Pending |
| DISC-03 | Phase 23 | Pending |
| DISC-04 | Phase 23 | Pending |
| IDX-01 | Phase 24 | Pending |
| IDX-02 | Phase 24 | Pending |
| IDX-03 | Phase 24 | Pending |
| IDX-04 | Phase 24 | Pending |
| INTEL-01 | Phase 25 | Pending |
| INTEL-02 | Phase 25 | Pending |
| INTEL-03 | Phase 25 | Pending |
| INTEL-04 | Phase 25 | Pending |
| INTEL-05 | Phase 26 | Complete |
| INTEL-06 | Phase 26 | Complete |
| NLTR-01 | Phase 27 | Complete |
| NLTR-02 | Phase 27 | Complete |
| NLTR-03 | Phase 27 | Complete |
| NLTR-04 | Phase 27 | Complete |
| FUN-01 | Phase 27 | Complete |

**Coverage:**
- v2.2 requirements: 27 total
- Mapped to phases: 27
- Unmapped: 0

---
*Requirements defined: 2026-02-22*
*Last updated: 2026-02-22 after v2.2 roadmap creation*
