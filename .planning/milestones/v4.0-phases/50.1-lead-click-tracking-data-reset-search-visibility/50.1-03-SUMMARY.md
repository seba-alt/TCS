---
phase: 50.1-lead-click-tracking-data-reset-search-visibility
plan: 03
subsystem: database
tags: [sqlite, sqlalchemy, python, cli, data-reset]

# Dependency graph
requires:
  - phase: 50.1-01
    provides: LeadClick model in app.models (required for inclusion in TABLES_TO_WIPE)
provides:
  - One-time pre-launch data reset script with dry-run safety (scripts/reset_for_launch.py)
affects: [launch, data-management]

# Tech tracking
tech-stack:
  added: []
  patterns: [sys.path.insert for standalone scripts that import from app/]

key-files:
  created:
    - scripts/reset_for_launch.py
  modified: []

key-decisions:
  - "Dry-run is default (safe by default) — --confirm required for actual deletion"
  - "TABLES_TO_WIPE ordering: Feedback first (no FKs to conversations), then Conversation, then leads — safe delete order"
  - "Script uses sys.path.insert to resolve app imports without requiring PYTHONPATH configuration"

patterns-established:
  - "Standalone scripts: sys.path.insert(0, project_root) enables direct import of app.models and app.database"

requirements-completed: [50.1-DATA-RESET]

# Metrics
duration: 5min
completed: 2026-02-27
---

# Phase 50.1 Plan 03: Pre-Launch Data Reset Script Summary

**Standalone Python CLI script that wipes 6 transactional tables (conversations, leads, feedback, newsletter_subscribers, user_events, lead_clicks) while preserving expert data, with safe dry-run default and --confirm for actual deletion.**

## Performance

- **Duration:** 5 min
- **Started:** 2026-02-27T15:41:47Z
- **Completed:** 2026-02-27T15:46:30Z
- **Tasks:** 1
- **Files modified:** 1

## Accomplishments
- Created `scripts/reset_for_launch.py` with dry-run (default) and --confirm modes
- Included LeadClick in TABLES_TO_WIPE alongside 5 other transactional tables
- Script displays row counts per table in both modes — user can verify before confirming
- Expert data (experts, admin_users, settings, metadata.json, FAISS) entirely untouched

## Task Commits

Each task was committed atomically:

1. **Task 1: Create pre-launch data reset script** - `3287bd6` (feat)

**Plan metadata:** (see docs commit below)

## Files Created/Modified
- `scripts/reset_for_launch.py` - CLI script for pre-launch wipe of transactional data

## Decisions Made
- Dry-run is default (no args) — explicit `--confirm` required to delete. Prevents accidental data loss.
- TABLES_TO_WIPE delete Feedback before Conversation to avoid any potential query ordering issues.
- Used `sys.path.insert(0, project_root)` so the script can be run from any directory without setting PYTHONPATH.

## Deviations from Plan

None - plan executed exactly as written.

## Issues Encountered
- `python` command not found on macOS (python3 is the system default). Script runs correctly with `python3 scripts/reset_for_launch.py`. The shebang `#!/usr/bin/env python3` ensures portability.

## User Setup Required
None - no external service configuration required.

## Next Phase Readiness
- Reset script ready to run on Railway before public launch: `python3 scripts/reset_for_launch.py --confirm`
- All 3 plans in phase 50.1 complete (lead click tracking, data reset, search visibility)

---
*Phase: 50.1-lead-click-tracking-data-reset-search-visibility*
*Completed: 2026-02-27*
