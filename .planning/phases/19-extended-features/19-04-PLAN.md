---
phase: 19-extended-features
plan: "04"
type: execute
wave: 2
depends_on: []
files_modified:
  - frontend/src/components/marketplace/EmptyState.tsx
  - frontend/src/components/sidebar/TagMultiSelect.tsx
autonomous: true
requirements: [ROBUST-03]

must_haves:
  truths:
    - "EmptyState shows up to 6 tag suggestion pills from TOP_TAGS (excluding active tags)"
    - "Clicking a suggested tag calls setTags([tag]) — replaces current tags, does NOT add to existing"
    - "EmptyState shows a prominent Sage CTA: 'Not finding what you need? Try describing it to Sage.'"
    - "EmptyState shows a secondary 'Clear all filters' link that calls resetFilters()"
    - "Tag suggestions import TOP_TAGS from frontend/src/constants/tags.ts (not inline)"
  artifacts:
    - path: "frontend/src/components/marketplace/EmptyState.tsx"
      provides: "Enhanced EmptyState with tag suggestions + Sage CTA + clear all"
      contains: "TOP_TAGS"
    - path: "frontend/src/components/marketplace/EmptyState.tsx"
      provides: "Sage CTA opens panel"
      contains: "setOpen"
  key_links:
    - from: "frontend/src/components/marketplace/EmptyState.tsx"
      to: "frontend/src/constants/tags.ts"
      via: "import { TOP_TAGS }"
      pattern: "TOP_TAGS"
    - from: "frontend/src/components/marketplace/EmptyState.tsx"
      to: "frontend/src/store/filterSlice.ts"
      via: "setTags([tag]) — replaces, not additive"
      pattern: "setTags"
    - from: "frontend/src/components/marketplace/EmptyState.tsx"
      to: "frontend/src/store/pilotSlice.ts"
      via: "setOpen(true)"
      pattern: "setOpen"
---

<objective>
Enhance the EmptyState with tag suggestions, a prominent Sage CTA, and a clear-all escape hatch.

Purpose: ROBUST-03 — when search returns no results, users should not hit a dead end. Tag suggestions redirect users toward results (replacing their current tag filter). The Sage CTA completes the Phase 17 placeholder handoff. The clear-all link is a secondary escape hatch.

Output: `EmptyState.tsx` updated with tag suggestion pills, Sage CTA, and clear all link.
</objective>

<execution_context>
@/Users/sebastianhamers/.claude/get-shit-done/workflows/execute-plan.md
@/Users/sebastianhamers/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/STATE.md
@.planning/phases/19-extended-features/19-RESEARCH.md
@frontend/src/components/marketplace/EmptyState.tsx
@frontend/src/constants/tags.ts
@frontend/src/store/filterSlice.ts
@frontend/src/store/pilotSlice.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Enhance EmptyState with tag suggestions + Sage CTA + clear all</name>
  <files>frontend/src/components/marketplace/EmptyState.tsx</files>
  <action>
Read `frontend/src/components/marketplace/EmptyState.tsx` (already exists from Phase 17/18).

Replace the entire file with the enhanced version:

```tsx
import { Search } from 'lucide-react'
import { useExplorerStore } from '../../store'
import { TOP_TAGS } from '../../constants/tags'

export function EmptyState() {
  const setOpen = useExplorerStore((s) => s.setOpen)
  const tags = useExplorerStore((s) => s.tags)
  const setTags = useExplorerStore((s) => s.setTags)
  const resetFilters = useExplorerStore((s) => s.resetFilters)

  // Suggest tags not currently active — up to 6 from TOP_TAGS
  const suggestions = TOP_TAGS.filter((t) => !tags.includes(t)).slice(0, 6)

  function handleTagSuggestion(tag: string) {
    // Replace current tags entirely — per CONTEXT.md: suggestions are redirects not additions
    setTags([tag])
  }

  return (
    <div className="flex flex-col items-center justify-center h-full min-h-[400px] gap-6 text-center px-8">
      {/* Icon */}
      <div className="w-16 h-16 rounded-full bg-gray-100 flex items-center justify-center">
        <Search className="w-8 h-8 text-gray-400" />
      </div>

      {/* Message */}
      <div>
        <h3 className="font-semibold text-gray-700 text-base mb-1">No experts found</h3>
        <p className="text-sm text-gray-500 max-w-xs">
          Try a different tag or describe what you need to Sage.
        </p>
      </div>

      {/* Tag suggestions */}
      {suggestions.length > 0 && (
        <div className="flex flex-col items-center gap-2">
          <p className="text-xs text-gray-400 uppercase tracking-wide">Try one of these</p>
          <div className="flex flex-wrap gap-2 justify-center max-w-sm">
            {suggestions.map((tag) => (
              <button
                key={tag}
                onClick={() => handleTagSuggestion(tag)}
                className="text-xs bg-white border border-gray-200 text-gray-600 rounded-full px-3 py-1.5 hover:border-brand-purple hover:text-brand-purple transition-colors"
              >
                {tag}
              </button>
            ))}
          </div>
        </div>
      )}

      {/* Sage CTA — prominent */}
      <div className="flex flex-col items-center gap-2">
        <p className="text-sm text-gray-500">Not finding what you need?</p>
        <button
          onClick={() => setOpen(true)}
          className="text-sm text-brand-purple font-medium border border-brand-purple rounded-lg px-4 py-2 hover:bg-brand-purple hover:text-white transition-colors"
        >
          Try describing it to Sage
        </button>
      </div>

      {/* Clear all — secondary escape hatch */}
      <button
        onClick={resetFilters}
        className="text-xs text-gray-400 hover:text-gray-600 transition-colors"
      >
        Clear all filters
      </button>
    </div>
  )
}
```

After editing, run `npm run build` from `frontend/` — must pass.
  </action>
  <verify>
    npm run build from frontend/ — exits 0.
    grep -n "TOP_TAGS\|setTags\|setOpen\|resetFilters" frontend/src/components/marketplace/EmptyState.tsx — all four present.
    grep -n "Try describing it to Sage\|Clear all filters" frontend/src/components/marketplace/EmptyState.tsx — both strings present.
  </verify>
  <done>
    EmptyState shows up to 6 tag suggestion pills.
    Tag pills call setTags([tag]) — replace, not additive.
    Sage CTA: "Try describing it to Sage" calls setOpen(true).
    Clear all: calls resetFilters().
    TOP_TAGS imported from constants/tags.ts.
    Build passes.
  </done>
</task>

</tasks>

<verification>
npm run build from frontend/ — exits 0.
grep -n "TOP_TAGS" frontend/src/components/marketplace/EmptyState.tsx — imported from constants.
grep -n "setTags\(\[tag\]\)" frontend/src/components/marketplace/EmptyState.tsx — replace semantics.
grep -n "setOpen(true)" frontend/src/components/marketplace/EmptyState.tsx — Sage CTA wired.
grep -n "resetFilters" frontend/src/components/marketplace/EmptyState.tsx — clear all wired.
</verification>

<success_criteria>
- EmptyState shows up to 6 tag suggestions from TOP_TAGS (excluding active tags)
- Clicking suggestion calls setTags([tag]) — replaces current tags entirely
- "Try describing it to Sage" CTA calls setOpen(true)
- "Clear all filters" button calls resetFilters()
- TOP_TAGS imported from frontend/src/constants/tags.ts (not inline)
- Build passes with zero TypeScript errors
</success_criteria>

<output>
After completion, create `.planning/phases/19-extended-features/19-04-SUMMARY.md`
</output>
