---
phase: 21-documentation-cleanup
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - frontend/src/store/index.ts
  - frontend/src/components/marketplace/ExpertCard.tsx
  - frontend/src/components/marketplace/ExpertGrid.tsx
autonomous: true
requirements:
  - MARKET-05

must_haves:
  truths:
    - "Dead _state?.triggerSearch() comment is removed from store/index.ts"
    - "Dead index: number prop is removed from ExpertCardProps interface and ExpertGrid no longer passes index={index}"
    - "TypeScript build passes with zero errors after prop removal"
  artifacts:
    - path: "frontend/src/store/index.ts"
      provides: "Clean onRehydrateStorage callback with no stale comment"
      contains: "onRehydrateStorage"
    - path: "frontend/src/components/marketplace/ExpertCard.tsx"
      provides: "ExpertCardProps without dead index prop"
      contains: "onViewProfile"
    - path: "frontend/src/components/marketplace/ExpertGrid.tsx"
      provides: "ExpertGrid itemContent without index={index} pass-through"
      contains: "ExpertCard"
  key_links:
    - from: "frontend/src/components/marketplace/ExpertGrid.tsx"
      to: "frontend/src/components/marketplace/ExpertCard.tsx"
      via: "ExpertCard rendered without index prop"
      pattern: "ExpertCard expert=\\{expert\\}"
---

<objective>
Remove the two dead code artifacts identified during the v2.0 audit: the `_state?.triggerSearch()` comment in the Phase 15 Zustand store, and the dead `index: number` prop in ExpertCard/ExpertGrid (leftover from the removed stagger animation).

Purpose: Dead code misleads future readers about how the system works. The comment references a function that was never implemented; the index prop is declared and passed but never used. Both are clean removal — no behavior change.

Output: Three files with targeted dead code removed; TypeScript build verified clean. Committed separately from documentation changes per the locked commit convention.
</objective>

<execution_context>
@/Users/sebastianhamers/.claude/get-shit-done/workflows/execute-plan.md
@/Users/sebastianhamers/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/STATE.md
@.planning/phases/21-documentation-cleanup/21-CONTEXT.md
@.planning/phases/21-documentation-cleanup/21-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Remove dead onRehydrateStorage comment from store/index.ts</name>
  <files>frontend/src/store/index.ts</files>
  <action>
    Read `frontend/src/store/index.ts` in full first.

    Locate the `onRehydrateStorage` callback in the `persist` middleware config. The RESEARCH.md confirmed it looks like:
    ```typescript
    onRehydrateStorage: () => (_state) => {
      // Phase 16+ wires: _state?.triggerSearch()
    },
    ```

    Remove ONLY the dead comment line `// Phase 16+ wires: _state?.triggerSearch()`.
    Keep the `onRehydrateStorage: () => (_state) => { },` callback structure intact — it is a valid Zustand persist hook point.

    If the comment line is the only content in the callback body, the result should be an empty callback:
    ```typescript
    onRehydrateStorage: () => (_state) => {
    },
    ```

    Do not modify any other part of the file. Do not remove the `onRehydrateStorage` key itself.

    During the read, also scan for any other obviously dead comments referencing planned-but-not-implemented features (e.g., TODO comments referring to phase numbers for features that shipped differently). If found, remove them inline. If nothing else is found, document that in the task output.
  </action>
  <verify>
    - `grep -n "triggerSearch" frontend/src/store/index.ts` — must return zero matches
    - `grep -n "onRehydrateStorage" frontend/src/store/index.ts` — must still exist (callback kept)
    - `npx tsc --noEmit` from `frontend/` directory — exits 0 (no TypeScript errors introduced)
  </verify>
  <done>
    The dead comment `// Phase 16+ wires: _state?.triggerSearch()` is gone from store/index.ts. The onRehydrateStorage callback structure remains. TypeScript build clean.
  </done>
</task>

<task type="auto">
  <name>Task 2: Remove dead index prop from ExpertCard and ExpertGrid</name>
  <files>
    frontend/src/components/marketplace/ExpertCard.tsx
    frontend/src/components/marketplace/ExpertGrid.tsx
  </files>
  <action>
    Read both files in full before making any changes.

    In `frontend/src/components/marketplace/ExpertCard.tsx`:
    1. Locate `ExpertCardProps` interface — it has `index: number` as a prop (leftover from the removed stagger animation).
    2. Confirm `index` is NOT used anywhere in the component body (grep for `index` — it should only appear in the interface declaration and possibly the function signature, not in JSX or logic).
    3. Remove `index: number` from the `ExpertCardProps` interface.
    4. If `index` appears in the function destructuring `({ expert, index, onViewProfile })`, remove it from there too. If it is NOT destructured (which research suggests — only in the interface), no change needed to the function signature.

    In `frontend/src/components/marketplace/ExpertGrid.tsx`:
    1. Locate the `itemContent` render function where `ExpertCard` is rendered.
    2. Find `index={index}` in the ExpertCard JSX call.
    3. Remove `index={index}` from the props passed to `ExpertCard`.
    4. If the `index` parameter in the `itemContent={(index, expert) => ...}` callback is now unused, rename it to `(_index, expert)` to satisfy TypeScript unused-variable rules, or remove it if ExpertGrid provides no index parameter to itemContent — check the VirtuosoGrid itemContent signature first to decide.

    Do not change any other aspect of either component.

    Run `npm run build` from `frontend/` to confirm zero TypeScript errors after the removals.
  </action>
  <verify>
    - `grep -n "index: number" frontend/src/components/marketplace/ExpertCard.tsx` — zero matches
    - `grep -n "index={index}" frontend/src/components/marketplace/ExpertGrid.tsx` — zero matches
    - `npm run build` from `frontend/` — exits 0 with no TypeScript errors
  </verify>
  <done>
    The dead `index: number` prop is removed from ExpertCardProps. ExpertGrid no longer passes `index={index}` to ExpertCard. TypeScript build passes clean.
  </done>
</task>

</tasks>

<verification>
After both tasks complete:
1. `grep -rn "triggerSearch" frontend/src/` — zero matches
2. `grep -n "index: number" frontend/src/components/marketplace/ExpertCard.tsx` — zero matches
3. `grep -n "index={index}" frontend/src/components/marketplace/ExpertGrid.tsx` — zero matches
4. `npm run build` from `frontend/` — exits 0

Commit these three files as a separate code commit (distinct from Plan 01 doc commit):
- `frontend/src/store/index.ts`
- `frontend/src/components/marketplace/ExpertCard.tsx`
- `frontend/src/components/marketplace/ExpertGrid.tsx`
</verification>

<success_criteria>
- store/index.ts has no reference to triggerSearch
- ExpertCard.tsx ExpertCardProps interface has no index property
- ExpertGrid.tsx does not pass index={index} to ExpertCard
- TypeScript build passes (npm run build exits 0)
- Changes committed as a separate code commit from documentation changes
</success_criteria>

<output>
After completion, create `.planning/phases/21-documentation-cleanup/21-02-SUMMARY.md`
</output>
