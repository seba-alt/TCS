---
phase: 38-browse-ui
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - frontend/src/hooks/useBrowse.ts
  - frontend/src/components/browse/BrowseCard.tsx
  - frontend/src/components/browse/SkeletonBrowseCard.tsx
  - frontend/src/components/browse/BrowseRow.tsx
  - frontend/src/components/browse/SkeletonBrowseRow.tsx
autonomous: true
requirements: [BROWSE-02, BROWSE-03, PHOTO-03]

must_haves:
  truths:
    - "BrowseCard renders expert photo from /api/photos/{username} proxy URL with full-card photo coverage"
    - "BrowseCard shows monogram initials fallback with gradient background when photo_url is null or image fails to load"
    - "BrowseCard shows frosted overlay with name and hourly rate at all times"
    - "BrowseCard expands on hover revealing tags row; on mobile tap-to-expand replaces hover"
    - "BrowseRow renders a horizontal scrollable row of BrowseCards with snap scroll, hidden scrollbar, and fade edge overlays"
    - "BrowseRow shows a See All link in the row header (right-aligned) and a See All end-of-row card at the scroll end"
    - "SkeletonBrowseRow renders 6 skeleton card placeholders matching BrowseCard dimensions while data loads"
  artifacts:
    - path: "frontend/src/hooks/useBrowse.ts"
      provides: "Data fetching hook for GET /api/browse"
      exports: ["useBrowse", "BrowseCard", "BrowseRow", "BrowseData"]
    - path: "frontend/src/components/browse/BrowseCard.tsx"
      provides: "Glassmorphic expert card with photo/monogram + hover expand"
      min_lines: 60
    - path: "frontend/src/components/browse/BrowseRow.tsx"
      provides: "Horizontal scroll row with snap, fade edges, See All"
      min_lines: 40
    - path: "frontend/src/components/browse/SkeletonBrowseCard.tsx"
      provides: "Skeleton placeholder matching BrowseCard dimensions"
      min_lines: 8
    - path: "frontend/src/components/browse/SkeletonBrowseRow.tsx"
      provides: "Row of skeleton cards for loading state"
      min_lines: 10
  key_links:
    - from: "frontend/src/hooks/useBrowse.ts"
      to: "/api/browse"
      via: "fetch with AbortController"
      pattern: "fetch.*api/browse"
    - from: "frontend/src/components/browse/BrowseCard.tsx"
      to: "/api/photos/{username}"
      via: "img src from expert.photo_url"
      pattern: "photo_url"
    - from: "frontend/src/components/browse/BrowseRow.tsx"
      to: "BrowseCard"
      via: "maps over experts array"
      pattern: "experts\\.map"
---

<objective>
Build the Browse page data hook and reusable card/row components: useBrowse fetches the API, BrowseCard renders a glassmorphic expert tile with photo or monogram, BrowseRow arranges cards in a horizontal snap-scrolling row with fade edges and See All affordances, and skeleton components handle loading state.

Purpose: These are the building blocks that BrowsePage (Plan 02) assembles into the full Netflix-style landing experience.
Output: 5 new files (1 hook, 4 components) ready for page-level composition.
</objective>

<execution_context>
@/Users/sebastianhamers/.claude/get-shit-done/workflows/execute-plan.md
@/Users/sebastianhamers/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/38-browse-ui/38-RESEARCH.md

# Key existing files to reference
@frontend/src/hooks/useExplore.ts
@frontend/src/store/index.ts
@frontend/src/index.css
@frontend/src/components/ExpertCard.tsx
@frontend/src/components/marketplace/ExpertGrid.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create useBrowse hook, BrowseCard with monogram fallback</name>
  <files>
    frontend/src/hooks/useBrowse.ts
    frontend/src/components/browse/BrowseCard.tsx
  </files>
  <action>
**1. Create `frontend/src/hooks/useBrowse.ts`:**

Export TypeScript interfaces: `BrowseCard` (matching the backend `_serialize_browse_card` shape — username, first_name, last_name, job_title, company, hourly_rate, category, tags, photo_url, profile_url), `BrowseRow` (title, slug, experts: BrowseCard[], total: number), `BrowseData` (featured: BrowseCard[], rows: BrowseRow[]).

Export `useBrowse()` hook:
- Uses `useState` for `data: BrowseData | null`, `loading: boolean` (init true), `error: string | null`
- `useEffect` with `AbortController` — fetches `${API_BASE}/api/browse?per_row=10` (API_BASE from `import.meta.env.VITE_API_URL ?? ''`)
- On success: `setData(d); setLoading(false)`
- On error (non-abort): `setError(err.message ?? 'Fetch failed'); setLoading(false)`
- Cleanup: `controller.abort()`
- Returns `{ data, loading, error }`

Follow the same pattern as `useExplore.ts` for API_BASE and fetch style but keep it simple — no Zustand, no pagination. This is page-local state.

**2. Create `frontend/src/components/browse/BrowseCard.tsx`:**

Create directory `frontend/src/components/browse/` if it does not exist.

Export `BrowseCard` component accepting `{ expert: BrowseCardType }` (import BrowseCard type as BrowseCardType from useBrowse to avoid name collision, or use a different import alias).

Card structure (~160px wide, ~220px min-height):
- Outer `motion.div` from `motion/react` with `className="relative rounded-xl overflow-hidden cursor-pointer group"`, `style={{ width: 160, minHeight: 220 }}`, `whileHover={{ scale: 1.04, height: 260 }}` (expands to show tags), `transition={{ type: 'spring', stiffness: 300, damping: 25 }}`.
- Photo layer: If `expert.photo_url` exists and no img error, render `<img src={expert.photo_url} alt={name} className="absolute inset-0 w-full h-full object-cover" onError={() => setImgError(true)} />`. Otherwise render `MonogramFallback`.
- Frosted overlay at bottom: `<div className="absolute bottom-0 left-0 right-0 p-2.5 bg-gradient-to-t from-black/70 via-black/40 to-transparent">` — do NOT use `.glass-surface` here because the card root has `overflow-hidden` which breaks backdrop-filter (see research Pitfall 1). Use dark gradient overlay instead (Netflix pattern).
  - Name: `<p className="text-sm font-semibold text-white truncate">{expert.first_name} {expert.last_name}</p>`
  - Rate: `<p className="text-xs text-purple-300 font-medium">${expert.hourly_rate}/hr</p>` (use euro sign per existing convention if present in ExpertCard, otherwise dollar)
- Tags row (hidden by default, revealed on hover): Use `<div className="opacity-0 group-hover:opacity-100 transition-opacity duration-200 mt-1 flex flex-wrap gap-1">` inside the overlay. Render first 2-3 tags as small pills: `<span className="text-[10px] px-1.5 py-0.5 rounded-full bg-white/20 text-white/90">{tag}</span>`. Limit to 3 tags max to prevent overflow.
- Mobile tap-to-expand: Add `onClick` handler that toggles a local `expanded` boolean state. On mobile (no hover), use `expanded` to control tag visibility: `className={expanded || 'group-hover' ? 'opacity-100' : 'opacity-0'}`. The second tap on an expanded card opens `expert.profile_url` in a new tab (`window.open(expert.profile_url, '_blank')`).

**MonogramFallback** — define as a local function inside BrowseCard.tsx (not a separate file):
- Props: `{ initials: string }`
- Render: `<div className="absolute inset-0 bg-gradient-to-br {gradient} flex items-center justify-center">`
- Gradient selection: Array of 6 brand-aligned gradients (purple/indigo/violet palette). Pick via `initials.charCodeAt(0) % gradients.length` for deterministic color per expert.
- Initials text: `<span className="text-white text-3xl font-bold tracking-wider select-none">{initials}</span>`
- Compute initials as `${expert.first_name[0]}${expert.last_name[0]}`.toUpperCase() — guard against empty strings.
  </action>
  <verify>
    <automated>cd /Users/sebastianhamers/Documents/TCS/frontend && npx tsc --noEmit 2>&1 | head -30</automated>
    <manual>Inspect BrowseCard.tsx: photo img with onError, MonogramFallback with gradient, frosted dark overlay with name+rate, hover tag reveal, mobile tap toggle</manual>
  </verify>
  <done>useBrowse hook fetches /api/browse and returns typed { data, loading, error }. BrowseCard renders photo with monogram fallback, dark gradient overlay with name + rate always visible, tags revealed on hover/tap, and mobile second-tap opens profile.</done>
</task>

<task type="auto">
  <name>Task 2: Create SkeletonBrowseCard, BrowseRow, SkeletonBrowseRow</name>
  <files>
    frontend/src/components/browse/SkeletonBrowseCard.tsx
    frontend/src/components/browse/BrowseRow.tsx
    frontend/src/components/browse/SkeletonBrowseRow.tsx
  </files>
  <action>
**1. Create `frontend/src/components/browse/SkeletonBrowseCard.tsx`:**

Export `SkeletonBrowseCard` — a simple div matching BrowseCard dimensions:
```tsx
<div className="animate-pulse rounded-xl bg-gray-200/30 shrink-0" style={{ width: 160, height: 220 }} />
```
Use `bg-gray-200/30` (semi-transparent) to fit with the aurora background aesthetic. The `animate-pulse` class is already Tailwind built-in.

**2. Create `frontend/src/components/browse/BrowseRow.tsx`:**

Export `BrowseRow` component accepting `{ title: string, slug: string, experts: BrowseCardType[], total: number, onSeeAll: (slug: string, title: string) => void }`.

Structure:
- Row header: `<div className="flex items-center justify-between mb-3 px-4 md:px-8">`:
  - Left: `<h2 className="text-xl font-bold text-white">{title}</h2>`
  - Right: `<button onClick={() => onSeeAll(slug, title)} className="text-sm text-purple-300 hover:text-white transition-colors flex items-center gap-1">See All <ChevronRight className="w-4 h-4" /></button>` (import ChevronRight from lucide-react)
- Scroll container wrapper: `<div className="relative">` (for fade overlays)
  - Left fade: `<div className="pointer-events-none absolute left-0 top-0 h-full w-16 bg-gradient-to-r from-[var(--aurora-bg,#0a0a1a)] to-transparent z-10" />`
  - Right fade: `<div className="pointer-events-none absolute right-0 top-0 h-full w-16 bg-gradient-to-l from-[var(--aurora-bg,#0a0a1a)] to-transparent z-10" />`
  - Scroll div: `<div className="flex gap-3 overflow-x-auto snap-x snap-mandatory px-4 md:px-8 [scrollbar-width:none] [-ms-overflow-style:none] [&::-webkit-scrollbar]:hidden">`:
    - Map experts: `{experts.map(expert => <div key={expert.username} className="snap-start shrink-0"><BrowseCard expert={expert} /></div>)}`
    - End-of-row "See All" card: `<div className="snap-start shrink-0"><SeeAllEndCard total={total} title={title} slug={slug} onClick={() => onSeeAll(slug, title)} /></div>`

**SeeAllEndCard** — define locally inside BrowseRow.tsx:
- Same dimensions as BrowseCard (160px wide, 220px height)
- Visual: `<div className="rounded-xl bg-white/5 border border-white/10 flex flex-col items-center justify-center cursor-pointer hover:bg-white/10 transition-colors" style={{ width: 160, height: 220 }}>`:
  - `<ChevronRight className="w-8 h-8 text-purple-300 mb-2" />`
  - `<span className="text-sm text-white font-medium">See All</span>`
  - `<span className="text-xs text-gray-400">{total} experts</span>`

Check the `--aurora-bg` CSS variable — verify it exists in `index.css`. If not, use a hardcoded dark color like `#0a0a1a` or the project's bg color. The fade edges must match the page background so cards appear to fade into the background.

**3. Create `frontend/src/components/browse/SkeletonBrowseRow.tsx`:**

Export `SkeletonBrowseRow` accepting `{ count?: number }` (default 6):
- Row header skeleton: `<div className="flex items-center justify-between mb-3 px-4 md:px-8"><div className="animate-pulse bg-gray-200/20 rounded h-6 w-48" /><div className="animate-pulse bg-gray-200/20 rounded h-4 w-16" /></div>`
- Card row: `<div className="flex gap-3 overflow-hidden px-4 md:px-8">{Array.from({ length: count }).map((_, i) => <SkeletonBrowseCard key={i} />)}</div>`
  </action>
  <verify>
    <automated>cd /Users/sebastianhamers/Documents/TCS/frontend && npx tsc --noEmit 2>&1 | head -30</automated>
    <manual>Inspect BrowseRow: horizontal flex with snap-x snap-mandatory, hidden scrollbar, fade overlays, See All header link, See All end card. Inspect skeletons: animate-pulse, matching card dimensions.</manual>
  </verify>
  <done>BrowseRow renders horizontal snap-scroll row with fade edges, See All in header and as end card. SkeletonBrowseCard and SkeletonBrowseRow provide loading placeholders matching exact card dimensions. All 5 browse component files exist and compile.</done>
</task>

</tasks>

<verification>
1. `cd frontend && npx tsc --noEmit` — zero type errors
2. All 5 new files exist: useBrowse.ts, BrowseCard.tsx, BrowseRow.tsx, SkeletonBrowseCard.tsx, SkeletonBrowseRow.tsx
3. BrowseCard has: photo img with onError, MonogramFallback, dark gradient overlay, hover tag reveal, mobile tap
4. BrowseRow has: snap-x scroll, hidden scrollbar, fade edges, See All header + end card
5. useBrowse returns { data, loading, error } with BrowseData typed response
</verification>

<success_criteria>
- TypeScript compiles with zero errors
- BrowseCard renders photo from photo_url with monogram fallback when null/error
- BrowseRow shows horizontal scroll with snap behavior, no visible scrollbar, fade edge cues
- See All appears both in row header (right-aligned) and as end-of-row card
- Skeleton components match card dimensions and use animate-pulse
- All components ready for BrowsePage assembly in Plan 02
</success_criteria>

<output>
After completion, create `.planning/phases/38-browse-ui/38-01-SUMMARY.md`
</output>
