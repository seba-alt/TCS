---
phase: 03-frontend
plan: "02"
type: execute
wave: 2
depends_on:
  - "03-01"
files_modified:
  - frontend/src/components/Header.tsx
  - frontend/src/components/ChatInput.tsx
  - frontend/src/components/ChatMessage.tsx
  - frontend/src/components/ExpertCard.tsx
  - frontend/src/components/EmptyState.tsx
autonomous: true
requirements:
  - CHAT-01
  - CHAT-02
  - REC-03
  - REC-04

must_haves:
  truths:
    - "Header renders Tinrate logo (/logo.png) and tagline on all screen sizes"
    - "ChatInput is a touch-friendly textarea that submits on Enter (desktop) or tap of Send button (mobile), never overflows 375px viewport"
    - "ExpertCard displays name, job title, company, hourly rate, and 'why them' explanation — clicking opens profile_url in a new tab"
    - "Expert Cards stack vertically one per row on all screen sizes"
    - "ChatMessage renders user messages right-aligned and assistant messages left-aligned"
    - "EmptyState shows a welcome message and 2-3 example prompt suggestion buttons"
  artifacts:
    - path: "frontend/src/components/Header.tsx"
      provides: "Fixed top header with logo and tagline"
      min_lines: 15
    - path: "frontend/src/components/ChatInput.tsx"
      provides: "Fixed bottom input bar with textarea and Send button"
      min_lines: 40
    - path: "frontend/src/components/ChatMessage.tsx"
      provides: "Individual chat message bubble (user or assistant)"
      min_lines: 30
    - path: "frontend/src/components/ExpertCard.tsx"
      provides: "Clickable expert recommendation card opening profile URL in new tab"
      min_lines: 35
    - path: "frontend/src/components/EmptyState.tsx"
      provides: "Welcome message with example prompt suggestion chips"
      min_lines: 25
  key_links:
    - from: "frontend/src/components/ExpertCard.tsx"
      to: "expert.profile_url"
      via: "anchor tag with target='_blank' rel='noopener noreferrer'"
      pattern: "target.*_blank"
    - from: "frontend/src/components/ChatInput.tsx"
      to: "onSubmit prop"
      via: "form onSubmit + button onClick"
      pattern: "onSubmit"
    - from: "frontend/src/components/ExpertCard.tsx"
      to: "frontend/src/types.ts"
      via: "import { Expert } from '../types'"
      pattern: "import.*Expert.*types"
---

<objective>
Build all presentational React components: Header, ChatInput, ChatMessage, ExpertCard, and EmptyState. These are pure UI components with no API calls — they accept props and render markup.

Purpose: Isolating UI from state/data concerns means components can be developed, previewed, and verified independently before the SSE hook is wired in Plan 03.
Output: Five component files, fully typed with props interfaces, styled with Tailwind and Tinrate brand colors, mobile-first and responsive.
</objective>

<execution_context>
@/Users/sebastianhamers/.claude/get-shit-done/workflows/execute-plan.md
@/Users/sebastianhamers/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/03-frontend/03-CONTEXT.md
@.planning/phases/03-frontend/03-01-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Build Header, ChatMessage, and EmptyState components</name>
  <files>
    frontend/src/components/Header.tsx
    frontend/src/components/ChatMessage.tsx
    frontend/src/components/EmptyState.tsx
  </files>
  <action>
    Create the `frontend/src/components/` directory and build three components.

    **Header.tsx** — Fixed top bar with logo and tagline:
    ```tsx
    // Persistent top header — always visible, sticks to top of viewport.
    // Logo: served from /logo.png (user places PNG at frontend/public/logo.png).
    // If logo.png is missing, the alt text "Tinrate" renders as fallback.

    export default function Header() {
      return (
        <header className="fixed top-0 left-0 right-0 z-10 bg-brand-black px-4 py-3 flex items-center gap-3 border-b border-neutral-800">
          <img
            src="/logo.png"
            alt="Tinrate"
            className="h-8 w-auto"
            onError={(e) => {
              // Hide broken image icon if logo.png is not yet placed
              (e.target as HTMLImageElement).style.display = 'none'
            }}
          />
          <p className="text-sm text-neutral-400 hidden sm:block">
            Find the right expert, instantly
          </p>
        </header>
      )
    }
    ```

    **ChatMessage.tsx** — Single message bubble with streaming and expert card support:

    Import: `import { Message } from '../types'`
    Import ExpertCard (will be created in Task 2, create a placeholder import that will resolve after Task 2):
    `import ExpertCard from './ExpertCard'`

    Props: `{ message: Message }`

    Layout rules (from CONTEXT.md):
    - User messages: right-aligned, black background, white text
    - Assistant messages: left-aligned, light gray background, black text
    - If `message.isStreaming === true`: show blinking cursor after text (CSS `after:` pseudo — simple `animate-pulse` span appended)
    - If `message.experts` exists and has length > 0: render an ExpertCard for each expert below the narrative text (stacked vertically, full width)

    ```tsx
    import { Message } from '../types'
    import ExpertCard from './ExpertCard'

    interface Props {
      message: Message
    }

    export default function ChatMessage({ message }: Props) {
      const isUser = message.role === 'user'

      return (
        <div className={`flex ${isUser ? 'justify-end' : 'justify-start'} mb-3`}>
          <div className={`max-w-[85%] sm:max-w-[75%] ${isUser ? 'order-1' : ''}`}>
            {/* Message bubble */}
            <div
              className={`rounded-2xl px-4 py-3 text-sm leading-relaxed whitespace-pre-wrap break-words ${
                isUser
                  ? 'bg-brand-black text-white rounded-br-sm'
                  : 'bg-neutral-100 text-neutral-900 rounded-bl-sm'
              }`}
            >
              {message.content}
              {message.isStreaming && (
                <span className="inline-block w-0.5 h-4 ml-0.5 bg-neutral-500 animate-pulse align-middle" />
              )}
            </div>

            {/* Expert Cards — stacked vertically, rendered below assistant message */}
            {!isUser && message.experts && message.experts.length > 0 && (
              <div className="mt-3 space-y-3">
                {message.experts.map((expert) => (
                  <ExpertCard key={expert.profile_url} expert={expert} />
                ))}
              </div>
            )}
          </div>
        </div>
      )
    }
    ```

    **EmptyState.tsx** — Welcome message + 3 example prompt chips:

    Props: `{ onPromptSelect: (prompt: string) => void }`

    Three hardcoded example prompts (Claude's discretion per CONTEXT.md):
    1. "I need help scaling my e-commerce store to its first $1M in revenue"
    2. "I'm looking for a fractional CFO to help me raise a Series A"
    3. "I need an expert in employment law to review a contractor agreement"

    ```tsx
    interface Props {
      onPromptSelect: (prompt: string) => void
    }

    const EXAMPLE_PROMPTS = [
      "I need help scaling my e-commerce store to its first $1M in revenue",
      "I'm looking for a fractional CFO to help me raise a Series A",
      "I need an expert in employment law to review a contractor agreement",
    ]

    export default function EmptyState({ onPromptSelect }: Props) {
      return (
        <div className="flex flex-col items-center justify-center h-full px-6 py-12 text-center">
          <p className="text-2xl font-semibold text-neutral-900 mb-2">
            What problem can I help you solve today?
          </p>
          <p className="text-sm text-neutral-500 mb-8 max-w-sm">
            Describe your challenge and I'll match you with three experts who can help.
          </p>
          <div className="flex flex-col gap-3 w-full max-w-md">
            {EXAMPLE_PROMPTS.map((prompt) => (
              <button
                key={prompt}
                onClick={() => onPromptSelect(prompt)}
                className="text-left px-4 py-3 rounded-xl border border-neutral-200 text-sm text-neutral-700 hover:border-brand-purple hover:text-brand-purple transition-colors duration-150"
              >
                {prompt}
              </button>
            ))}
          </div>
        </div>
      )
    }
    ```
  </action>
  <verify>
    From `frontend/`:
    `npm run build` — must exit 0 with no TypeScript errors across all three component files.
    Check: `grep -n "target.*_blank\|profile_url" frontend/src/components/ChatMessage.tsx || echo "ExpertCard handles this"` — ExpertCard handles the link (fine at this stage; Task 2 will create ExpertCard).
  </verify>
  <done>
    Header.tsx, ChatMessage.tsx, and EmptyState.tsx all exist in `frontend/src/components/`. `npm run build` exits 0. No TypeScript errors.
  </done>
</task>

<task type="auto">
  <name>Task 2: Build ExpertCard and ChatInput components</name>
  <files>
    frontend/src/components/ExpertCard.tsx
    frontend/src/components/ChatInput.tsx
  </files>
  <action>
    **ExpertCard.tsx** — Clickable card that opens the expert's Tinrate profile in a new tab.

    CONTEXT.md decisions:
    - Vertically stacked, one card per row
    - Shows: avatar/profile photo, name, job title, company, hourly rate, "why them" explanation (always visible, no toggle)
    - Clicking opens profile_url in a new tab

    The `Expert` type (from types.ts) does NOT include a `why_them` field — the "why them" explanation is part of the narrative text from the LLM. At the card level, display the available fields only: name, title, company, hourly_rate, profile_url. Avatar: use first letter of name as fallback (no photo URL in the Expert type).

    ```tsx
    import { Expert } from '../types'

    interface Props {
      expert: Expert
    }

    export default function ExpertCard({ expert }: Props) {
      const initials = expert.name
        .split(' ')
        .map((n) => n[0])
        .join('')
        .toUpperCase()
        .slice(0, 2)

      return (
        <a
          href={expert.profile_url}
          target="_blank"
          rel="noopener noreferrer"
          className="block w-full rounded-xl border border-neutral-200 bg-white p-4 hover:border-brand-purple hover:shadow-sm transition-all duration-150 group"
        >
          <div className="flex items-start gap-3">
            {/* Avatar — initials fallback (no photo URL in Expert type) */}
            <div
              className="flex-shrink-0 w-10 h-10 rounded-full bg-brand-purple flex items-center justify-center text-white text-sm font-semibold"
              aria-hidden="true"
            >
              {initials}
            </div>

            {/* Expert info */}
            <div className="flex-1 min-w-0">
              <p className="font-semibold text-neutral-900 text-sm group-hover:text-brand-purple transition-colors truncate">
                {expert.name}
              </p>
              <p className="text-xs text-neutral-600 truncate">
                {expert.title} @ {expert.company}
              </p>
              <p className="text-xs font-medium text-brand-purple mt-1">
                {expert.hourly_rate}/hr
              </p>
            </div>

            {/* External link indicator */}
            <svg
              xmlns="http://www.w3.org/2000/svg"
              viewBox="0 0 20 20"
              fill="currentColor"
              className="w-4 h-4 text-neutral-400 group-hover:text-brand-purple flex-shrink-0 mt-0.5 transition-colors"
              aria-hidden="true"
            >
              <path
                fillRule="evenodd"
                d="M4.25 5.5a.75.75 0 00-.75.75v8.5c0 .414.336.75.75.75h8.5a.75.75 0 00.75-.75v-4a.75.75 0 011.5 0v4A2.25 2.25 0 0112.75 17h-8.5A2.25 2.25 0 012 14.75v-8.5A2.25 2.25 0 014.25 4h5a.75.75 0 010 1.5h-5z"
                clipRule="evenodd"
              />
              <path
                fillRule="evenodd"
                d="M6.194 12.753a.75.75 0 001.06.053L16.5 4.44v2.81a.75.75 0 001.5 0v-4.5a.75.75 0 00-.75-.75h-4.5a.75.75 0 000 1.5h2.553l-9.056 8.194a.75.75 0 00-.053 1.06z"
                clipRule="evenodd"
              />
            </svg>
          </div>
        </a>
      )
    }
    ```

    ---

    **ChatInput.tsx** — Fixed bottom input bar. Touch-friendly, works on 375px viewport.

    CONTEXT.md decisions:
    - Fixed bottom, always visible
    - Submit on Enter (desktop) — Shift+Enter inserts newline
    - Tap Send button (mobile)
    - Touch-friendly (large tap targets, min-height on textarea)

    Props:
    ```ts
    interface Props {
      onSubmit: (value: string) => void
      disabled: boolean   // true while API request is in flight
    }
    ```

    Implementation notes:
    - Use `<textarea>` not `<input>` — grows with content up to 5 rows, then scrolls
    - Auto-resize via `rows` state or CSS (use CSS `field-sizing: content` not supported in all browsers; use `onInput` resize instead)
    - On Enter key (without Shift): call onSubmit(value.trim()), clear input — prevent form submission
    - While `disabled`: textarea is readonly, button shows spinner, button background is neutral-300
    - Send button: brand-purple background when enabled

    ```tsx
    import { useRef, useState, KeyboardEvent } from 'react'

    interface Props {
      onSubmit: (value: string) => void
      disabled: boolean
    }

    export default function ChatInput({ onSubmit, disabled }: Props) {
      const [value, setValue] = useState('')
      const textareaRef = useRef<HTMLTextAreaElement>(null)

      const handleSubmit = () => {
        const trimmed = value.trim()
        if (!trimmed || disabled) return
        onSubmit(trimmed)
        setValue('')
        // Reset textarea height
        if (textareaRef.current) {
          textareaRef.current.style.height = 'auto'
        }
      }

      const handleKeyDown = (e: KeyboardEvent<HTMLTextAreaElement>) => {
        if (e.key === 'Enter' && !e.shiftKey) {
          e.preventDefault()
          handleSubmit()
        }
      }

      const handleInput = () => {
        const el = textareaRef.current
        if (!el) return
        el.style.height = 'auto'
        // Cap at ~5 rows (approx 120px)
        el.style.height = `${Math.min(el.scrollHeight, 120)}px`
      }

      return (
        <div className="fixed bottom-0 left-0 right-0 z-10 bg-white border-t border-neutral-200 px-4 py-3 safe-area-pb">
          <div className="flex items-end gap-2 max-w-3xl mx-auto">
            <textarea
              ref={textareaRef}
              value={value}
              onChange={(e) => setValue(e.target.value)}
              onKeyDown={handleKeyDown}
              onInput={handleInput}
              rows={1}
              disabled={disabled}
              placeholder="Describe your problem..."
              className="flex-1 resize-none rounded-xl border border-neutral-300 px-4 py-3 text-sm text-neutral-900 placeholder-neutral-400 focus:outline-none focus:ring-2 focus:ring-brand-purple focus:border-transparent disabled:bg-neutral-50 disabled:cursor-not-allowed min-h-[48px] max-h-[120px] overflow-y-auto leading-relaxed"
              aria-label="Message input"
            />
            <button
              onClick={handleSubmit}
              disabled={disabled || !value.trim()}
              className="flex-shrink-0 w-12 h-12 rounded-xl flex items-center justify-center transition-colors duration-150 disabled:cursor-not-allowed bg-brand-purple disabled:bg-neutral-300 hover:bg-purple-700 active:bg-purple-800"
              aria-label="Send message"
            >
              {disabled ? (
                /* Spinner */
                <svg className="animate-spin w-5 h-5 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                  <circle className="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" strokeWidth="4" />
                  <path className="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8v8H4z" />
                </svg>
              ) : (
                /* Send arrow */
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" className="w-5 h-5 text-white">
                  <path d="M3.478 2.405a.75.75 0 00-.926.94l2.432 7.905H13.5a.75.75 0 010 1.5H4.984l-2.432 7.905a.75.75 0 00.926.94 60.519 60.519 0 0018.445-8.986.75.75 0 000-1.218A60.517 60.517 0 003.478 2.405z" />
                </svg>
              )}
            </button>
          </div>
        </div>
      )
    }
    ```

    Add `safe-area-pb` to the Tailwind config as a utility for iOS safe-area-inset-bottom support. In `tailwind.config.ts`, inside `theme.extend`:
    ```ts
    // No custom plugin needed — use padding-bottom: env(safe-area-inset-bottom)
    // Applied inline via style prop instead of class to avoid PostCSS complexity:
    ```
    Actually, use a `style` prop on the fixed container instead of a Tailwind class:
    ```tsx
    <div
      className="fixed bottom-0 left-0 right-0 z-10 bg-white border-t border-neutral-200 px-4 py-3"
      style={{ paddingBottom: 'max(12px, env(safe-area-inset-bottom))' }}
    >
    ```
    Remove `safe-area-pb` class from className — use the inline style approach above. This is simpler and avoids Tailwind plugin complexity.
  </action>
  <verify>
    From `frontend/`:
    1. `npm run build` exits 0 with no TypeScript errors
    2. `grep -n "target.*_blank" frontend/src/components/ExpertCard.tsx` returns a match (confirms new-tab navigation)
    3. `grep -n "profile_url" frontend/src/components/ExpertCard.tsx` returns a match
    4. `grep -n "onSubmit\|handleSubmit" frontend/src/components/ChatInput.tsx` returns matches
    5. `grep -n "disabled" frontend/src/components/ChatInput.tsx` returns multiple matches (textarea and button disabled states)
  </verify>
  <done>
    ExpertCard.tsx renders expert details and opens profile_url in a new tab via anchor tag with target="_blank". ChatInput.tsx is a textarea-based input that submits on Enter, shows spinner while disabled, and uses inline style for iOS safe-area padding. `npm run build` exits 0.
  </done>
</task>

</tasks>

<verification>
From `frontend/`:
1. `npm run build` exits 0 — all 5 components pass TypeScript compilation
2. `grep -rn "target.*_blank" frontend/src/components/ExpertCard.tsx` — confirms new-tab navigation
3. `grep -rn "import.*Expert.*types" frontend/src/components/ExpertCard.tsx` — confirms typed Expert prop
4. `grep -rn "onPromptSelect" frontend/src/components/EmptyState.tsx` — confirms callback prop
5. `grep -n "env(safe-area-inset-bottom)" frontend/src/components/ChatInput.tsx` — confirms iOS safe area handling
</verification>

<success_criteria>
- All 5 components (Header, ChatMessage, ExpertCard, ChatInput, EmptyState) exist in `frontend/src/components/`
- `npm run build` exits 0 with no TypeScript errors
- ExpertCard uses an `<a>` tag with `target="_blank"` and `rel="noopener noreferrer"` linking to `expert.profile_url`
- Expert Cards are styled for vertically stacked layout (one per row, full width within container)
- ChatInput textarea is touch-friendly (min-height 48px, large send button, iOS safe-area inset handled)
- All components import from `../types` using named TypeScript types (no `any`)
</success_criteria>

<output>
After completion, create `.planning/phases/03-frontend/03-02-SUMMARY.md` following the summary template.
</output>
